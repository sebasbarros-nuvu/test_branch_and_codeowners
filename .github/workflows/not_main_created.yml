name: Validate branch origin

on:
  push:
    branches:
      - '**'
    branches-ignore:
      - main

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Fetch all
        run: git fetch --all

      - name: Validate that branch is not created from main
        run: |
          echo "Validating branch creation..."
          CURRENT=$(git rev-parse HEAD)

          echo "Checking if HEAD exists in origin/main..."
          if git merge-base --is-ancestor "$CURRENT" origin/main; then
            echo "❌ No puedes crear ramas desde main."
            exit 1
          fi

          echo "✔️ Validación pasada. La rama no proviene de main."
